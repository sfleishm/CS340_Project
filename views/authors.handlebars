{{!-- Trying the way prof did it  --}}
<h1>Current people:</h1>
<h1>Handlebars JS Example</h1>
{{#each foo}}
{{this}}
{{/each}}
<table>
    <thead> 
        <th>ID</th> 
        <th>Name</th>
        <th>Delete</th>  
        <th>Update</th> 
    </thead> 
    <tbody> 
        {{#each authors}} 
        <tr> 
            <td>{{authorID}}</td> 
            <td>{{authorName}}</td> 
            <td><button onclick="deletePerson({{id}})">Delete</button></td>
            <td><a href="/people/{{id}}">Update</a></td>
        </tr> 
        {{/each}} 
    </tbody> 
    
</table> 



<!-- Hello Part -->
<div class="container">
    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
        <p class="lead">Find all Authors in the Database.</p>
    </div>

    <!-- Search Bar -->
    <div class="input-group ">
        <input type="search" class="form-control rounded" onkeyup="myFunction()" id='bookFilter' placeholder="Search by Author" aria-label="Search"
            aria-describedby="search-addon" />
        <button type="button" class="btn btn-outline-primary">search</button>
    </div>

    <!-- Table for Authors -->
    <div class="container" id='tableID'>
        <table class="table justify-content-center">
            <thead class="thead-dark">
            <tr>
                <th scope="col">Author ID</th>
                <th scope="col">First Name</th>
                <th scope="col">Last Name</th>
                <th scope="col">Update Row</th>
                <th scope="col">Delete Row</th>

            </tr>
            </thead>
            <tbody id = 'tbody'>
            {{#each authors}} 
            <tr>
              <td>{{authorID}}</td> 
              <td>{{firstName}}</td> 
              <td>{{lastName}}</td> 
              {{!-- <td><button onclick="deletePerson({{id}})">Delete</button></td>
              <td><a href="/people/{{id}}">Update</a></td> --}}
                {{!-- <th scope="row">1</th>
                <td>JRR</td>
                <td>Tolkien</td> --}}
              <td><button type="button" class="btn btn-primary">Update</button></td>
              <td><button type="button" class="btn btn-danger">Delete</button></td>
            </tr>
             {{/each}} 
            </tbody>
        </table>
    </div>

    <script>
      
      function myFunction() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById('bookFilter');
        filter = input.value;
        table = document.getElementById('tbody');
        tr = table.getElementsByTagName("tr");
        
        // This works for the date or index [2]
        // for (i = 0; i < tr.length; i++) {
        //   td = tr[i].getElementsByTagName("td")[2];
        //   if (td) {
        //     txtValue = td.textContext || td.innerText;
        //     if (txtValue.toUpperCase().indexOf(filter) > -1) {
        //       tr[i].style.display = "";
        //     } else {
        //       tr[i].style.display = 'none';
        //     } 
        //   }
        // }

        // This works for Book Titles [index 0]
        for (i = 0; i < tr.length; i++) {
          console.log(tr.length)
          td = tr[i].getElementsByTagName("td")[0];
          if (td) {
            // console.log(td)
            txtValue = td.textContext || td.innerText;
            // console.log(txtValue)
            if (txtValue.toUpperCase().includes(filter.toUpperCase())) {
              console.log(txtValue, 'here text log')
              tr[i].style.display = "";
            } else {
              tr[i].style.display = 'none';
            } 
          }
        }
      }
      var express = require('express');
      var router = express.Router();

      function getAuthors(res, mysql, context, complete){
          mysql.pool.query("SELECT authorID, firstName, lastName FROM Authors", function(error, results, fields){
              if(error){
                  res.write(JSON.stringify(error));
                  res.end();
              }
              context.authors = results;
              complete();
          });
      }

      router.get('/', function(req, res){
          // var callbackCount = 0;
          var context = {};
          // context.jsscripts = ["deleteperson.js"];
          var mysql = req.app.get('mysql');
          // getPeople(res, mysql, context, complete);
          getAuthors(res, mysql, context, complete);

      });
    </script>
</div>
